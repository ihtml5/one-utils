!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.oneUtils={})}(this,function(e){"use strict";var n=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t=function(e){return"string"==typeof e},r=function(e){return"function"==typeof e},o=function(e){return void 0===e},i=function(e){return"number"==typeof e},u=Object.prototype.hasOwnProperty,c={web:0,wxapp:1,node:2,webworker:3,unknown:"unknown"},a=function(e){return e.constructor.toString().match(/^function\s+(\w+)\s*\(\)\s*\{\s*\[native code\]\s*\}$/)[1]}(window||global),l=function(e){var t=e.engine;return n(t)&&t.login?c.wxapp:t===window?c.web:t===global?c.node:-1!==["DedicatedWorkerGlobalScope","SharedWorkerGlobalScope","ServiceWorkerGlobalScope"].indexOf(a)?c.webworker:c.unknown},s=(function(){function e(e){this.value=e}function n(n){var t,r;function o(t,r){try{var u=n[t](r),c=u.value;c instanceof e?Promise.resolve(c.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(u.done?"return":"normal",u.value)}catch(e){i("throw",e)}}function i(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?o(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(i,u){var c={key:e,arg:n,resolve:i,reject:u,next:null};r?r=r.next=c:(t=r=c,o(e,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}),f=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),h=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e);var t=n.engine;this.engine=t}return f(e,[{key:"querySelector",value:function(e){return this.nodeList=this.engine.document.querySelector(""+e),this.nodeList}},{key:"querySelectorAll",value:function(e){return this.nodeList=this.engine.document.querySelectorAll(""+e),this.nodeList}},{key:"getBoundingClientRect",value:function(e){return r(e)&&e(this.nodeList.getBoundingClientRect()),this.nodeList.getBoundingClientRect()}},{key:"fetch",value:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}(function(e){var n=e.method,t=e.url,r=e.body,o=e.header;return fetch({url:t,method:n,body:r,header:o})})}]),e}(),d=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e);var t=n.engine;this.engine=t}return f(e,[{key:"querySelector",value:function(e){return this.nodeList=this.engine.createSelectorQuery().select(""+e),this.nodeList}},{key:"querySelectorAll",value:function(e){return this.nodeList=this.engine.createSelectorQuery().selectAll(""+e),this.nodeList}},{key:"getBoundingClientRect",value:function(e){var t=this;return new Promise(function(o,i){t.nodeList.boundingClientRect().exec(function(t){var i=n(t[0])?t[0]:t;r(e)&&e(i),o(i)})})}},{key:"fetch",value:function(e){var n=this,t=e.method,r=e.url,o=e.body,i=e.header;return new Promise(function(e,u){return n.engine.request({url:r,data:o,method:t,header:i,success:e,fail:u,complete:emptyFunction})})}}]),e}(),g=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return console.log.apply(null,n)},y=function(e){var n=e.engine,t=l({engine:n});g(t,c,n);var r=null;return t===c.web&&(r=new h({engine:n})),t===c.wxapp&&(r=new d({engine:n}),g("AdapterIns:::",r)),r},v=-1,p={},b={on:function(e,n,t){p[e]||(p[e]=[]);var r=config.nameSpace+"-uid-"+v++;return p[e].push({context:t,cb:n,token:r}),r},clearAll:function(){p={}},clear:function(e){p[e]&&delete p[e]},off:function(e){var n="string"==typeof e&&(u.call(p,e)||function(e){for(var n in p)if(u.call(p,n)&&0===n.indexOf(e))return!0;return!1}(e)),t=!n&&"string"==typeof e,r="function"==typeof e,o=null,i=!0,c=null;if(!n){for(o in p)if(u.call(p,o))for(var a=0,l=(c=p[o]).length;a<l;a++)t&&c[a].token===e?(c.splice(a,1),i=e):r&&c[a].cb===e&&(p[o].splice(a,1),i=!0);return i}b.clear(e)},once:function(e,n){p[e]||(p[e]=[]),p[e].push({context:this,cb:n,once:!0})},trigger:function(e,n,t){if(u.call(p,e))return!0===t?setTimeout(o,0):o(),!0;function r(e,n,t){function r(n){e.cb&&e.cb.call(e.context,n),e.once&&(e.cb=function(){})}if(!0===t)try{r(n)}catch(e){setTimeout((o=e,function(){throw o}),0)}var o;r(n)}function o(){if(u.call(p,e))for(var o=p[e],i=o.length,c=0;c<i;c++)r(o[c],n,t)}}},w={phoneNumber:/^[1][3,4,5,7,8][0-9]{9}$/,email:/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/,qq:/^[0-9]{5,10}$/},m=function(e){return function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return new Promise(function(t,o){return e.apply(void 0,[Object.assign({},n,{success:t,fail:o})].concat(r))})}},k=b.$on,S=b.$off,x=b.$once,q=b.$trigger,$=function(){function e(u){var c=u.engine,a=u.log,f=u.promisfy,h=u.on,d=u.off,v=u.once,p=u.trigger,b=u.regex,$=void 0===b?{}:b;s(this,e),this.engine=c,this.adapterIns=y({engine:c}),g("this.adapterIns====",this.adapterIns),this.$log=a||g,this.promisfy=f||m,this.regex=Object.assign({},w,$),this.types={isObject:n,isString:t,isFunction:r,isUndefined:o,isNumber:i},this.getEnv=l,this.$on=h||k,this.$off=d||S,this.$once=v||x,this.$trigger=p||q}return f(e,[{key:"fetch",value:function(e){var n=e.method,t=void 0===n?"GET":n,r=e.body,o=void 0===r?{}:r,i=e.header,u=void 0===i?{}:i,c=e.url,a=void 0===c?"":c;return this.adapterIns.fetch({url:a,method:t,body:o,header:u})}},{key:"querySelector",value:function(e){return g("this.adapterIns",this),this.adapterIns.querySelector(e)}},{key:"querySelectorAll",value:function(e){return this.adapterIns.querySelectorAll(e)}},{key:"getBoundingClientRect",value:function(e){return this.adapterIns.getBoundingClientRect(e)}}]),e}();e.create=function(e){var n=e.engine;return new $({engine:n})},Object.defineProperty(e,"__esModule",{value:!0})});
