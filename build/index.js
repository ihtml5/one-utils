!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.oneUtils={})}(this,function(e){"use strict";var t=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n=function(e){return"string"==typeof e},r=function(e){return"function"==typeof e},o=function(e){return void 0===e},i=function(e){return"number"==typeof e},s=0,u=1,c=2,f=3,a="unknown",l=function(e){return e.constructor.toString().match(/^function\s+(\w+)\s*\(\)\s*\{\s*\[native code\]\s*\}$/)[1]}(window||global),h=function(e){var n=e.engine;return t(n)&&n.login?u:n===window?s:n===global?c:-1!==["DedicatedWorkerGlobalScope","SharedWorkerGlobalScope","ServiceWorkerGlobalScope"].indexOf(l)?f:a},p=(function(){function e(e){this.value=e}function t(t){var n,r;function o(n,r){try{var s=t[n](r),u=s.value;u instanceof e?Promise.resolve(u.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(s.done?"return":"normal",s.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?o(n.key,n.arg):r=null}this._invoke=function(e,t){return new Promise(function(i,s){var u={key:e,arg:t,resolve:i,reject:s,next:null};r?r=r.next=u:(n=r=u,o(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e);var n=t.engine;this.engine=n}return v(e,[{key:"querySelector",value:function(e){return this.nodeList=this.engine.document.querySelector(""+e),this.nodeList}},{key:"querySelectorAll",value:function(e){return this.nodeList=this.engine.document.querySelectorAll(""+e),this.nodeList}},{key:"getBoundingClientRect",value:function(e){return r(e)&&e(this.nodeList.getBoundingClientRect()),this.nodeList.getBoundingClientRect()}}]),e}(),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e);var n=t.engine;this.engine=n}return v(e,[{key:"querySelector",value:function(e){return this.nodeList=this.engine.createSelectorQuery().select(""+e),this.nodeList}},{key:"querySelectorAll",value:function(e){return this.nodeList=this.engine.createSelectorQuery().selectAll(""+e),this.nodeList}},{key:"getBoundingClientRect",value:function(e){var n=this;return new Promise(function(o,i){n.nodeList.boundingClientRect().exec(function(n){var i=t(n[0])?n[0]:n;r(e)&&e(i),o(i)})})}}]),e}();function m(){}function d(){d.init.call(this)}function w(e){return void 0===e._maxListeners?d.defaultMaxListeners:e._maxListeners}function b(e,t,n,r){var o,i,s,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]):(i=e._events=new m,e._eventsCount=0),s){if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(o=w(e))&&o>0&&s.length>o){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,u=c,"function"==typeof console.warn?console.warn(u):console.log(u)}}else s=i[t]=n,++e._eventsCount;return e}function _(e,t,n){var r=!1;function o(){e.removeListener(t,o),r||(r=!0,n.apply(e,arguments))}return o.listener=n,o}function L(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function x(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function S(){var e;d.call(this),this.__emitError=(e=this,function(t){e.emit("error",t)})}m.prototype=Object.create(null),d.EventEmitter=d,d.usingDomains=!1,d.prototype.domain=void 0,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.init=function(){this.domain=null,d.usingDomains&&(!(void 0).active||this instanceof(void 0).Domain||(this.domain=(void 0).active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new m,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},d.prototype.getMaxListeners=function(){return w(this)},d.prototype.emit=function(e){var t,n,r,o,i,s,u,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(u=this.domain,c){if(t=arguments[1],!u){if(t instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=u,t.domainThrown=!1,u.emit("error",t),!1}if(!(n=s[e]))return!1;var a="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,o=x(e,r),i=0;i<r;++i)o[i].call(n)}(n,a,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,i=x(e,o),s=0;s<o;++s)i[s].call(n,r)}(n,a,this,arguments[1]);break;case 3:!function(e,t,n,r,o){if(t)e.call(n,r,o);else for(var i=e.length,s=x(e,i),u=0;u<i;++u)s[u].call(n,r,o)}(n,a,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,o,i){if(t)e.call(n,r,o,i);else for(var s=e.length,u=x(e,s),c=0;c<s;++c)u[c].call(n,r,o,i)}(n,a,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];!function(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,i=x(e,o),s=0;s<o;++s)i[s].apply(n,r)}(n,a,this,o)}return!0},d.prototype.addListener=function(e,t){return b(this,e,t,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(e,t){return b(this,e,t,!0)},d.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,_(this,e,t)),this},d.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,_(this,e,t)),this},d.prototype.removeListener=function(e,t){var n,r,o,i,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new m:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new m,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,o=e.length;r<o;n+=1,r+=1)e[n]=e[r];e.pop()}(n,o);r.removeListener&&this.emit("removeListener",e,s||t)}return this},d.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new m,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new m:delete n[e]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new m,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},d.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},d.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):L.call(e,t)},d.prototype.listenerCount=L,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},("function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e})(S,d),S.prototype.add=function(e){e.on("error",this.__emitError)},S.prototype.remove=function(e){e.removeListener("error",this.__emitError)},S.prototype.bind=function(e){var t=this.__emitError;return function(){var n=Array.prototype.slice.call(arguments);try{e.apply(null,n)}catch(e){t(e)}}},S.prototype.intercept=function(e){var t=this.__emitError;return function(n){if(n)t(n);else{var r=Array.prototype.slice.call(arguments,1);try{e.apply(null,r)}catch(n){t(n)}}}},S.prototype.run=function(e){var t=this.__emitError;try{e()}catch(e){t(e)}return this},S.prototype.dispose=function(){return this.removeAllListeners(),this},S.prototype.enter=S.prototype.exit=function(){return this};var k=function(e){var t=e.engine,n=h({engine:t}),r=null;return n===s&&(r=new y({engine:t})),n===u&&(r=new g({engine:t})),r},A=function(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return new Promise(function(n,o){return e.apply(void 0,[Object.assign({},t,{success:n,fail:o})].concat(r))})}},C=function(e){if(t(e)){var i=e.key,s=e.data,u=e.success,c=e.fail,f=(e.complete,e.sync);if(!n(i)&&!o(i))return!1;if(!n(s)||!t(s))return!1;if(!r(u)&&!f&&!o(c))return!1;if(!r(c)&&!f&&!o(c))return!1}return!1},E=function(){if(C(itemInfo)){var e=itemInfo,t=e.key,n=e.data,r=(e.success,e.fail,e.complete,e.sync);try{return r?wx.setStorageSync(t,n):wx.setStorage(itemInfo)}catch(e){console.warn("请检查传入的参数是否正确"+itemInfo)}}console.warn("请检查传入的参数是否正确"+itemInfo)},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(C(e)){var t=e.key,n=(e.data,e.success,e.fail,e.complete,e.sync);try{return n?wx.getStorageSync(t):wx.getStorage(e)}catch(t){console.warn("请检查传入的参数是否正确"+e)}}console.warn("请检查传入的参数是否正确"+e)},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(C(e))try{e.success,e.fail,e.complete;return e.sync?wx.getStorageInfoSync():wx.getStorage(e)}catch(t){console.warn("请检查传入的参数是否正确"+e)}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(C(e)){var t=info,n=t.key,r=(t.success,t.fail,t.complete,t.sync);try{r&&wx.removeStorageSync(n),wx.removeStorage(e)}catch(e){console.warn("请检查传入的参数是否正确"+info)}}console.warn("请检查传入的参数是否正确"+info)},j=function(e){return e?wx.clearStorageSync():wx.clearStorage()},q=new(function(){function e(){p(this,e)}return v(e,[{key:"init",value:function(e){var t=e.engine;return this.AdapterIns=k({engine:t}),this}},{key:"querySelector",value:function(e){return console.log(this.AdapterIns),this.AdapterIns.querySelector(e)}},{key:"querySelectorAll",value:function(e){return this.selector=e,this.AdapterIns.querySelectorAll(e)}},{key:"getBoundingClientRect",value:function(e){return this.AdapterIns.getBoundingClientRect(e)}}]),e}()),T=function(e){return new Promise(function(t,n){return wx["getSystemInfo"+(e?"Sync":"")]({success:t,fail:n})})},U=function(){},$=function(){return new Promise(function(e,t){return wx.login({success:e,fail:t,complete:U})})},R=function(){return new Promise(function(e,t){return wx.getUserInfo({success:e,fail:t,complete:U})})},M=function(){return new Promise(function(e,t){wx.getLocation({type:"wgs84",success:e,fail:t,complete:U})})},B=function(e){var t=e.url,n=e.method,r=e.data,o=e.header;return new Promise(function(e,i){return wx.request({url:t,data:r,method:n,header:o,success:e,fail:i,complete:U})})},W=function(){var e=getCurrentPages();return e[e.length-1].route},D=function(){var e=W(),t=currentPage.options,n=e+"?";for(var r in t){n+=r+"="+t[r]+"&"}return n=n.substring(0,n.length-1)},N=Object.prototype.hasOwnProperty,G=-1,z={},Q={on:function(e,t,n){z[e]||(z[e]=[]);var r=config.nameSpace+"-uid-"+G++;return z[e].push({context:n,cb:t,token:r}),r},clearAll:function(){z={}},clear:function(e){z[e]&&delete z[e]},off:function(e){var t="string"==typeof e&&(N.call(z,e)||function(e){for(var t in z)if(N.call(z,t)&&0===t.indexOf(e))return!0;return!1}(e)),n=!t&&"string"==typeof e,r="function"==typeof e,o=null,i=!0,s=null;if(!t){for(o in z)if(N.call(z,o))for(var u=0,c=(s=z[o]).length;u<c;u++)n&&s[u].token===e?(s.splice(u,1),i=e):r&&s[u].cb===e&&(z[o].splice(u,1),i=!0);return i}Q.clear(e)},once:function(e,t){z[e]||(z[e]=[]),z[e].push({context:this,cb:t,once:!0})},trigger:function(e,t,n){if(N.call(z,e))return!0===n?setTimeout(o,0):o(),!0;function r(e,t,n){function r(t){e.cb&&e.cb.call(e.context,t),e.once&&(e.cb=function(){})}if(!0===n)try{r(t)}catch(e){setTimeout((o=e,function(){throw o}),0)}var o;r(t)}function o(){if(N.call(z,e))for(var o=z[e],i=o.length,s=0;s<i;s++)r(o[s],t,n)}}},Z={phoneNumber:/^[1][3,4,5,7,8][0-9]{9}$/,email:/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/,qq:/^[0-9]{5,10}$/},F=function(e){return console.log(e)},J=Q.on,K=Q.off,V=Q.trigger,H=Q.once;e.create=function(e){var s=e.engine;return q.init({engine:s}),{getEnv:h,isObject:t,isString:n,isFunction:r,isUndefined:o,isNumber:i,setItem:E,getItem:I,removeAll:j,removeItem:O,getAll:P,isVaildItemParams:C,fetch:B,getLoginCode:$,getUserInfo:R,getJWD:M,getSystemInfo:T,promisfy:A,getCurrentPageUrl:W,getCurrentPageUrlWithArgs:D,$on:J,$off:K,$trigger:V,$once:H,regex:Z,$log:F,adapter:k,engine:s,dom:q}},Object.defineProperty(e,"__esModule",{value:!0})});
